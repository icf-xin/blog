# 计算机网络

## 网络层次
网络层次：应用层、表示层、会话层、传输层、网络层、数据链路层、物理层

应用层、传输层、网络层、数据链路层、物理层

应用层、传输层、网络层、网络接口层

## 常见应用层协议

DNS（域名系统）：用于实现网络设备名字到IP地址映射的网络服务。

FTP（文件传输协议）：用于实现交互式文件传输功能。支持两种模式：Standard（主动模式）、被动模式（Passive）

SMTP（简单邮件传送协议）：用于实现电子邮箱传送功能

HTTP（超文本传输协议）：用于实现WWW服务。

## 常见传输层协议
常见传输层协议：

### TCP与UDP

> TCP:
>
> 1. 面向连接的传输控制协议TCP
> 2. 传送数据前必须建立连接，数据传送后要释放连接，不提供广播或者多播服务，由于TCP要提供可靠的面向连接的传输服务，因此不可避免添加了许多开销、确认，流量控制，计时器及连接管理。
> 3. 可靠，面向连接，时延长，适用于大文件
>
> UDP:
>
> 1. 无连接的用户数据报协议UDP
> 2. 传输数据前不需要建立连接，收到UDP报文也不需要给出任何确认。
> 3. 不可靠，无连接，时延小，适用于小文件。

## 常见网络层协议

网络层协议，OSI参考模型的第三层。它控制通信子网进行工作，提供建立、保持和释放连接的手段，保证传输层实体之间进行透明的数据传输。

### IP协议

IP主要包含三个方面的内容：IP编址方案、分组封装格式及分组转发规则。

**IP分组转发规则**

路由器仅根据网络地址进行转发。当IP数据包经由路由器转发时，如果目标网络与本地路由器直接连接，则直接将数据包交付给目标主机，否则，路由器会根据路由表查找路由信息，并将数据包转发给知名的下一条路由器，这被称为间接交付。路由器在间接交付的过程中，如果有到达目标网络的路由，则把数据包传送给路由表指明的下一条路由器；如果没有路由，但路由表中有一个默认路由，则把数据包传送给默认路由器，如果两者都没有，则丢弃数据包，并报告错误。

**分片** 

各种网络的数据帧都有一个最大传输单元（MTU）的限制，如以太网帧的MTU是1500；因此当路由器再转发IP包的时候，如果数据包的大小超过了出口链路最大的传输单元是，则将该数据包分解成足够多的小块，一边能够在目标链路上传输。这些ip分片被重新组装成一个IP包独立运输，并在到达目标主机的时候才会被重组起来。

**IP分组结构**

一个IP分组由首部和数据两部分组成。首部的前20字节是所有IP分组都必须有的，也称固定首部。在首部固定部分的后面是一些可选字段，其长度是可变的。

###ICMP协议

ICMP是一种面向无连接的协议，用于传输出错报告控制信息。它是一个非常重要的协议，它对于网络完全具有极其重要的意义。它属于网络层协议，主要用于主机与路由器之间传递控制信息，用于报告错误、交换受限控制和状态信息等。遇到IP数据无法无法访问目标、IP地址无法按当前的传输速率转发数据包时，会自动发送ICMP信息。



##常见数据链路层协议

### ARP ###
ARP，地址解析协议。处于网络层与链路层之间，ARP协议将一个IP地址解析为一个MAC地址。很多地方它与DNS类似，DNS是将域名解析为IP地址。

**查询过程**

查询主机内ARP缓存，是否存在该IP地址对应的MAC地址。

当源主机要发送数据的时候，首先检查自身ARP列表中是否存在对应的IP地址MAC地址对应关系，如果存在，则直接发送数据，如果没有，则以广播的形式向子网内所有主机发送ARP数据包，该数据包括的内容主要有，源主机IP地址，目的主机IP.

当子网内所有主机收到该数据包之后，检查ip地址是否包含自己的IP地址，如果不包含，则忽略该数据包。如果有，则从数据包中去除源主机IP与目的主机IP写入自身的ARP表，然后将自己的Mac地址写入ARP响应包中，告诉源主机，自己就是它想要的IP地址。

源主机收到相应包之后，将目的主机的IP和Mac对应关系存入自身ARP表，并且利用该信息发送数据，如果源主机一直没有收到ARP响应数据包，则表示ARP查询失败。

RARP，反向地址解析协议，处于网络层与链路层之间，将MAC地址转换为IP地址。

发送主机发送一个本地的RARP广播，在广播包中声明自己的MAC地址并且请求任何收到此请求的RARP服务器分配一个IP地址。本地网段上的RARP服务器收到此请求后，检查其RARP列表，查找该MAC对应的IP地址。如果存在，则RARP服务器就给源主机发送一个响应数据包，并且将该IP地址分配给对方主机使用。

如果不存在，则不做任何响应。

源主机收到RARP服务器的响应，就可以使用得到的IP地址进行通讯，如果没有收到，则说明，初始化失败。

